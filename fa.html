<link rel="import" href="fa.php?href=https://use.fontawesome.com/releases/v4.7.0/css/font-awesome-css.min.css">
<dom-module id="poly-fa">
    <template id="poly-fa-styler">
      <style include="poly-fa-style-module">
      </style>
    </template>
</dom-module>
<script>
    class polyFa extends Polymer.Element {

        static get is() {
            return 'poly-fa';
        }

        constructor() {
            super();
        }

        // Element class can define custom element reactions
        connectedCallback() {
            super.connectedCallback();
        }

    }
    // Associate the new class with an element name
    window.customElements.define('poly-fa', polyFa);

    function interrupt(int) {
        return new Promise(function() {
            var channel = new MessageChannel();
            channel.port2.onmessage = function(event) {
                if (event.data.error)
                    reject(event.data.error);
                else
                    resolve(event.data);
            };
            navigator.serviceWorker.controller.postMessage(int, [channel.port2]);
        });
    }

    function registrar(sw) {
        if ('serviceWorker' in navigator) {
            var activeSWRunning = {
                yes: 0
            };
            if (navigator.serviceWorker.controller !== null && navigator.serviceWorker.controller.state == 'activated') {
                var activeSWRunning = {
                    yes: 1,
                    scriptURL: navigator.serviceWorker.controller.scriptURL
                };
            }
            navigator.serviceWorker.register(sw)
                .then(function(registration) {
                    // Registration was successful
                    interrupt(JSON.stringify(activeSWRunning)).then(function(success) {

                    }).catch(function(err) {

                    });
                }, function(err) {
                    // registration failed :(
                    console.log('faSrv_Wrkr registration failed: ', err);
                });
        }
    }

    registrar('fa_sw.js');

</script>
