<dom-module id="poly-fa">
    <!--https://use.fontawesome.com/4ed3881c04.css-->
    <link rel="import" type="css" href="/fa.php?href=https://use.fontawesome.com/4ed3881c04.css">
    <template id="poly-fa-styler">
    </template>
</dom-module>
<script>
    function interrupt(int) {
        return new Promise(function() {
            var channel = new MessageChannel();
            channel.port2.onmessage = function(event) {
                if (event.data.error)
                    reject(event.data.error);
                else
                    resolve(event.data);
            };
            navigator.serviceWorker.controller.postMessage(int, [channel.port2]);
        });
    }

    function registrar(sw) {
        if ('serviceWorker' in navigator) {
            var activeSWRunning = {
                yes: 0
            };
            if (navigator.serviceWorker.controller !== null && navigator.serviceWorker.controller.state == 'activated') {
                var activeSWRunning = {
                    yes: 1,
                    scriptURL: navigator.serviceWorker.controller.scriptURL
                };
            }
            navigator.serviceWorker.register(sw)
                .then(function(registration) {
                    // Registration was successful
                    interrupt(JSON.stringify(activeSWRunning)).then(function(success) {}).catch(function(err) {

                    });
                }, function(err) {
                    // registration failed :(
                    console.log('faSrv_Wrkr registration failed: ', err);
                });
        }
    }
    class polyFa extends Polymer.Element {

        static get is() {
            return 'poly-fa';
        }

        constructor() {
            console.log('constructing poly-fa');
            super();
        }

        // Element class can define custom element reactions
        connectedCallback() {
            super.connectedCallback();
        }

        ready() {
            super.ready();
        }

    }

    // Associate the new class with an element name
    window.customElements.define('poly-fa', polyFa);
    registrar('/fa_sw.js');

</script>
